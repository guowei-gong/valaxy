---
title: Goå¹¶å‘WorkerPoolæ¨¡å¼
date: 2022-08-16 15:01:40
tags: 
    - Go
categories: 
    - æ›´å¥½çš„ç¼–ç¨‹
---

è¿™å¹¶ä¸æ˜¯è®¨è®ºå¹¶å‘æ¦‚å¿µçš„åšå®¢ï¼Œè€Œæ˜¯å¦‚ä½•ç¼–å†™ä»»åŠ¡å¹¶å‘æ‰§è¡Œã€‚ä½ å¯ä»¥å‚ç…§ä»£ç ç›´æ¥è¿›å…¥å®æ–½ã€‚

`Worker Pools` çº¿ç¨‹æ± æ˜¯ä¸€ç§å¹¶å‘æ¨¡å¼ã€‚è¯¥æ¨¡å¼ä¸­ç»´æŠ¤äº†å›ºå®šæ•°é‡çš„å¤šä¸ªå·¥ä½œå™¨ï¼Œè¿™äº›å·¥ä½œå™¨ç­‰å¾…ç€ç®¡ç†è€…åˆ†é…å¯å¹¶å‘æ‰§è¡Œçš„ä»»åŠ¡ã€‚è¯¥æ¨¡å¼é¿å…äº†çŸ­æ—¶é—´ä»»åŠ¡åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹çš„ä»£ä»·ã€‚

![img_2.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a9ea3fcb6db4c4aa3542c885d01db60~tplv-k3u1fbpfcp-watermark.image?)

åœ¨ `golang` ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ `goroutine` å’Œ `channel` æ¥æ„å»ºè¿™ç§æ¨¡å¼ã€‚å·¥ä½œå™¨ `worker` ç”±ä¸€ä¸ª `goroutine` å®šä¹‰ï¼Œè¯¥ `goroutine` é€šè¿‡ `channel` è·å–æ•°æ®ã€‚


æ¥ä¸‹æ¥è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œæ¥è¿›ä¸€æ­¥ç†è§£è¯¥æ¨¡å¼ã€‚å‡è®¾æ‚¨éœ€è¦å¤„ç†æ¥è‡ª `CVS` æ–‡ä»¶çš„è®°å½•æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å°†è¯¥æ–‡ä»¶ä¸­çš„ç»çº¬åº¦ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚ä»£ç å¦‚ä¸‹ã€‚ç‚¹å‡»[æ­¤å¤„](https://go.dev/play/p/aRlBPNrmpVT)å¯ä»¥è·å–ä»£ç ã€‚

> ğŸšš è·å–æµ‹è¯•æ•°æ® [cities.csv](https://github.com/guowei-gong/share_data/blob/main/cities.csv)

![img_1.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/95b2a0c3f1844d77bb3b82b443d7aeb6~tplv-k3u1fbpfcp-watermark.image?)


**è¾“å‡ºï¼š**

![img.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b5fdc52e72f44c6a8f5ab49a8e44ffc2~tplv-k3u1fbpfcp-watermark.image?)

æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œä¿å­˜ `CSV` ä¸­æ‰€æœ‰è®°å½•éœ€è¦ 55 ç§’ï¼Œè¿™æ˜¯å¾ˆé•¿çš„æ—¶é—´ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šæ€§èƒ½é—®é¢˜ã€‚ç”¨æˆ·å¦‚æœæƒ³è¦ä¸Šä¼  `CSV` æ–‡ä»¶ï¼Œé‚£ä½“éªŒæ„Ÿä¸€å®šå¾ˆå·®ã€‚

å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿé‚£æˆ‘ä»¬å°±ä½¿ç”¨çº¿ç¨‹æ± çš„æ–¹æ³•è¯•è¯•çœ‹ã€‚

åœ¨å¦‚ä¸‹ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†è§£å†³ç›¸åŒçš„éœ€æ±‚ï¼Œä½†é€šè¿‡çº¿ç¨‹æ± ï¼Œè€—æ—¶æ–¹é¢ï¼Œæˆ‘ä»¬èƒ½å¤Ÿçœ‹åˆ°å·¨å¤§çš„å·®å¼‚ã€‚æ¥å§ï¼ç‚¹å‡»[æ­¤å¤„](https://go.dev/play/p/TV36mid-evm)å¯ä»¥è·å–ä»£ç ã€‚

![img_4.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/42fd413d12a348baa8492c9caab750cd~tplv-k3u1fbpfcp-watermark.image?)



![img_3.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7d2f5eabcf8c4378a485be3f9ddd0473~tplv-k3u1fbpfcp-watermark.image?)

**è¾“å‡ºï¼š**

![img_5.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d8784163a8794afabe8a113c541f5589~tplv-k3u1fbpfcp-watermark.image?)

ä½ çœ‹åˆ°å¾ˆå¤§çš„ä¸åŒäº†å—ï¼Ÿç°åœ¨åŒæ ·çš„è¿‡ç¨‹åªéœ€è¦ 8 ç§’ã€‚æ­£å¦‚æ‚¨æ‰€è§ï¼Œå½“æˆ‘ä»¬éœ€è¦å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œçº¿ç¨‹æ± éå¸¸æœ‰ç”¨ã€‚

ä½¿ç”¨çº¿ç¨‹æ± ï¼Œæˆ‘ä»¬å¿…é¡»å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨ç¤ºä¾‹ä¸­è¯¥å‡½æ•°ä¸º `worker`ï¼Œè¯¥å‡½æ•°ç”¨äºå®šä¹‰å·¥ä½œè¿›ç¨‹ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å®ƒæ¥æ”¶ä¸€ä¸ª `Channel` é€šé“æ¥å¤„ç†æ•°æ®ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ•°æ®ä¼ é€’åˆ°é€šé“ä¹‹å‰å¯åŠ¨ `goroutines` åç¨‹ï¼Œå½“ `Channel` é€šé“è·å–åˆ°å€¼æ—¶ï¼Œ`goroutines` å·¥ä½œè€…å¼€å§‹å¤„ç†å®ƒä»¬ã€‚

ç°åœ¨çŸ¥é“å¦‚ä½•å®ç°çº¿ç¨‹æ± äº†ï¼Ù©( á› )( á– )Û¶ 